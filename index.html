<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="çŒ«è¯­ç¿»è¯‘">
<meta name="theme-color" content="#fff8f5">
<title>çŒ«è¯­ç¿»è¯‘å™¨ ğŸ¾</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Pacifico&display=swap" rel="stylesheet">
<style>
:root {
  --pink: #ff6b9d;
  --pink-light: #ffb3cd;
  --pink-bg: #fff0f5;
  --purple: #c084fc;
  --purple-light: #e9d5ff;
  --cream: #fff8f5;
  --yellow: #fde68a;
  --green: #6ee7b7;
  --text: #1f1f2e;
  --muted: #9ca3af;
  --white: #ffffff;
  --shadow: rgba(255,107,157,0.15);
  --radius: 20px;
}

* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }

html, body {
  height: 100%;
  background: var(--cream);
  font-family: 'Nunito', sans-serif;
  color: var(--text);
  overflow: hidden;
}

/* â”€â”€ App Shell â”€â”€ */
.app {
  display: flex;
  flex-direction: column;
  height: 100dvh;
  max-width: 480px;
  margin: 0 auto;
  position: relative;
  background: var(--cream);
}

/* â”€â”€ Top bar â”€â”€ */
.topbar {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 14px 20px 8px;
  position: relative;
  flex-shrink: 0;
}

.app-title {
  font-family: 'Pacifico', cursive;
  font-size: 22px;
  background: linear-gradient(135deg, var(--pink), var(--purple));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.cat-face {
  font-size: 22px;
  margin-right: 8px;
  display: inline-block;
  animation: catBlink 4s ease-in-out infinite;
}

@keyframes catBlink {
  0%,90%,100% { transform: scaleY(1); }
  95% { transform: scaleY(0.1); }
}

/* â”€â”€ Tab bar â”€â”€ */
.tabs {
  display: flex;
  background: var(--white);
  border-radius: 16px;
  margin: 0 16px 10px;
  padding: 4px;
  box-shadow: 0 2px 12px var(--shadow);
  flex-shrink: 0;
}

.tab-btn {
  flex: 1;
  border: none;
  background: transparent;
  padding: 8px 4px;
  border-radius: 12px;
  font-family: 'Nunito', sans-serif;
  font-size: 12px;
  font-weight: 700;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.25s;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}

.tab-btn .tab-icon { font-size: 18px; }

.tab-btn.active {
  background: linear-gradient(135deg, var(--pink), var(--purple));
  color: white;
  box-shadow: 0 4px 12px rgba(255,107,157,0.35);
}

/* â”€â”€ Pages â”€â”€ */
.pages { flex: 1; overflow: hidden; position: relative; }

.page {
  position: absolute;
  inset: 0;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 0 16px 100px;
  opacity: 0;
  transform: translateY(12px);
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
  -webkit-overflow-scrolling: touch;
}

.page.active {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

/* â”€â”€ Cards â”€â”€ */
.card {
  background: var(--white);
  border-radius: var(--radius);
  padding: 16px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.05);
  margin-bottom: 12px;
}

/* â”€â”€ Translate page â”€â”€ */
.mode-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}

.mode-pill {
  flex: 1;
  border: none;
  padding: 10px;
  border-radius: 14px;
  font-family: 'Nunito', sans-serif;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s;
  background: #f3f4f6;
  color: var(--muted);
}

.mode-pill.active {
  background: linear-gradient(135deg, var(--pink), var(--purple));
  color: white;
  box-shadow: 0 4px 12px rgba(255,107,157,0.3);
}

.swap-btn {
  width: 36px; height: 36px;
  border-radius: 50%;
  border: 2px solid var(--pink-light);
  background: white;
  color: var(--pink);
  font-size: 16px;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  transition: transform 0.3s;
}

.swap-btn:active { transform: rotate(180deg); }

.input-label {
  font-size: 11px;
  font-weight: 700;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 5px;
}

textarea {
  width: 100%;
  border: 2px solid #f0f0f0;
  border-radius: 14px;
  padding: 12px;
  font-family: 'Nunito', sans-serif;
  font-size: 15px;
  resize: none;
  outline: none;
  min-height: 90px;
  background: #fafafa;
  color: var(--text);
  transition: border-color 0.2s;
  -webkit-appearance: none;
}

textarea:focus { border-color: var(--pink-light); background: white; }
textarea::placeholder { color: #ccc; }

.translate-btn {
  width: 100%;
  padding: 14px;
  border: none;
  border-radius: 16px;
  background: linear-gradient(135deg, var(--pink), var(--purple));
  color: white;
  font-family: 'Nunito', sans-serif;
  font-size: 16px;
  font-weight: 800;
  cursor: pointer;
  margin: 12px 0;
  box-shadow: 0 6px 18px rgba(255,107,157,0.35);
  transition: transform 0.15s, box-shadow 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.translate-btn:active {
  transform: scale(0.97);
  box-shadow: 0 3px 10px rgba(255,107,157,0.25);
}

.translate-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Output */
.output-card {
  background: linear-gradient(135deg, rgba(255,107,157,0.06), rgba(192,132,252,0.08));
  border: 2px solid var(--pink-light);
  border-radius: 16px;
  padding: 14px;
  position: relative;
  min-height: 64px;
  animation: popIn 0.35s cubic-bezier(0.34,1.56,0.64,1);
}

@keyframes popIn {
  from { transform: scale(0.95); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.output-text {
  font-size: 17px;
  font-weight: 600;
  color: var(--text);
  line-height: 1.6;
  padding-right: 36px;
}

.copy-btn {
  position: absolute;
  top: 12px; right: 12px;
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  opacity: 0.5;
  transition: opacity 0.2s, transform 0.2s;
}

.copy-btn:active { transform: scale(0.85); opacity: 1; }

/* Record button */
.record-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  margin: 8px 0;
}

.record-btn {
  width: 60px; height: 60px;
  border-radius: 50%;
  border: none;
  background: linear-gradient(135deg, var(--pink), var(--purple));
  color: white;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 18px rgba(255,107,157,0.4);
  transition: transform 0.15s;
  display: flex; align-items: center; justify-content: center;
  position: relative;
}

.record-btn.recording {
  background: linear-gradient(135deg, #ef4444, #f97316);
  animation: recordPulse 1s ease-in-out infinite;
}

@keyframes recordPulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(239,68,68,0.4); }
  50% { box-shadow: 0 0 0 12px rgba(239,68,68,0); }
}

.record-label {
  font-size: 11px;
  color: var(--muted);
  font-weight: 600;
}

/* â”€â”€ Mood page â”€â”€ */
.mood-hero {
  text-align: center;
  padding: 20px 0 16px;
}

.mood-cat-big {
  font-size: 60px;
  display: block;
  margin-bottom: 8px;
  animation: floatCat 3s ease-in-out infinite;
}

@keyframes floatCat {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

.mood-title {
  font-size: 20px;
  font-weight: 800;
  color: var(--text);
}

.mood-sub {
  font-size: 13px;
  color: var(--muted);
  margin-top: 4px;
}

.mood-card-display {
  border-radius: 24px;
  padding: 28px 20px;
  margin-bottom: 14px;
  text-align: center;
  position: relative;
  overflow: hidden;
  min-height: 160px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
  transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1);
}

.mood-card-display::before {
  content: '';
  position: absolute;
  top: -30px; right: -30px;
  width: 120px; height: 120px;
  border-radius: 50%;
  background: rgba(255,255,255,0.15);
}

.mood-emoji-big { font-size: 52px; }
.mood-name {
  font-size: 16px;
  font-weight: 800;
  color: white;
  text-shadow: 0 1px 4px rgba(0,0,0,0.15);
}
.mood-quote {
  font-size: 14px;
  color: rgba(255,255,255,0.92);
  line-height: 1.6;
  max-width: 280px;
}

.generate-btn {
  width: 100%;
  padding: 14px;
  border: none;
  border-radius: 16px;
  background: linear-gradient(135deg, var(--pink), var(--purple));
  color: white;
  font-family: 'Nunito', sans-serif;
  font-size: 15px;
  font-weight: 800;
  cursor: pointer;
  box-shadow: 0 6px 18px rgba(255,107,157,0.35);
  margin-bottom: 16px;
  transition: transform 0.15s;
  display: flex; align-items: center; justify-content: center; gap: 8px;
}

.generate-btn:active { transform: scale(0.97); }

/* Mood chips */
.mood-chips {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  margin-bottom: 12px;
}

.mood-chip {
  background: white;
  border-radius: 12px;
  padding: 8px 4px;
  text-align: center;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  transition: transform 0.2s, box-shadow 0.2s;
  border: 2px solid transparent;
}

.mood-chip:active { transform: scale(0.92); }
.mood-chip.selected { border-color: var(--pink); }
.mood-chip .chip-emoji { font-size: 22px; }
.mood-chip .chip-name { font-size: 9px; color: var(--muted); font-weight: 700; margin-top: 2px; }

/* â”€â”€ Meow page â”€â”€ */
.meow-hero {
  text-align: center;
  padding: 16px 0;
}

.big-meow-btn {
  width: 130px; height: 130px;
  border-radius: 50%;
  border: none;
  background: linear-gradient(135deg, var(--pink), var(--purple));
  color: white;
  font-size: 40px;
  cursor: pointer;
  box-shadow: 0 10px 30px rgba(255,107,157,0.45);
  margin: 16px auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 4px;
  transition: transform 0.15s;
  position: relative;
}

.big-meow-btn:active { transform: scale(0.93); }

.big-meow-btn .btn-label {
  font-family: 'Nunito', sans-serif;
  font-size: 12px;
  font-weight: 800;
  opacity: 0.9;
}

.big-meow-btn.playing {
  animation: meowBounce 0.4s ease;
}

@keyframes meowBounce {
  0%,100% { transform: scale(1); }
  30% { transform: scale(1.12); }
  60% { transform: scale(0.95); }
}

/* Waveform */
.waveform {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  height: 36px;
  margin: 4px 0;
}

.wave-bar {
  width: 5px;
  border-radius: 3px;
  background: linear-gradient(180deg, var(--pink), var(--purple));
  height: 6px;
  transition: height 0.15s;
}

.waveform.active .wave-bar:nth-child(1) { animation: wave 0.6s 0.0s ease-in-out infinite alternate; }
.waveform.active .wave-bar:nth-child(2) { animation: wave 0.6s 0.1s ease-in-out infinite alternate; }
.waveform.active .wave-bar:nth-child(3) { animation: wave 0.6s 0.2s ease-in-out infinite alternate; }
.waveform.active .wave-bar:nth-child(4) { animation: wave 0.6s 0.0s ease-in-out infinite alternate; }
.waveform.active .wave-bar:nth-child(5) { animation: wave 0.6s 0.15s ease-in-out infinite alternate; }
.waveform.active .wave-bar:nth-child(6) { animation: wave 0.6s 0.05s ease-in-out infinite alternate; }
.waveform.active .wave-bar:nth-child(7) { animation: wave 0.6s 0.2s ease-in-out infinite alternate; }

@keyframes wave {
  from { height: 6px; }
  to { height: 28px; }
}

/* Sound grid */
.sound-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-bottom: 14px;
}

.sound-btn {
  background: white;
  border: 2px solid transparent;
  border-radius: 16px;
  padding: 14px 8px;
  cursor: pointer;
  text-align: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  transition: all 0.2s;
  font-family: 'Nunito', sans-serif;
}

.sound-btn:active { transform: scale(0.93); }

.sound-btn.playing {
  border-color: var(--pink);
  background: var(--pink-bg);
}

.sound-btn .s-emoji { font-size: 28px; }
.sound-btn .s-name {
  font-size: 11px;
  font-weight: 700;
  color: var(--muted);
  margin-top: 4px;
  display: block;
}

/* Meow guide */
.guide-card {
  background: white;
  border-radius: 16px;
  padding: 14px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.04);
}

.guide-title {
  font-size: 12px;
  font-weight: 800;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 10px;
}

.guide-row {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 0;
  border-bottom: 1px solid #f5f5f5;
}

.guide-row:last-child { border-bottom: none; }

.guide-sound {
  font-size: 12px;
  font-weight: 700;
  color: var(--pink);
  width: 88px;
  flex-shrink: 0;
}

.guide-meaning {
  font-size: 12px;
  color: var(--muted);
}

/* floating paws decoration */
.paw-float {
  position: fixed;
  font-size: 20px;
  opacity: 0.06;
  pointer-events: none;
  animation: pawFloat var(--dur) ease-in-out infinite var(--delay);
}

@keyframes pawFloat {
  0%,100% { transform: translateY(0) rotate(var(--rot)); }
  50% { transform: translateY(-15px) rotate(calc(var(--rot) + 10deg)); }
}

/* Toast */
.toast {
  position: fixed;
  bottom: 90px;
  left: 50%;
  transform: translateX(-50%) translateY(20px);
  background: rgba(31,31,46,0.88);
  color: white;
  padding: 10px 20px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
  opacity: 0;
  transition: all 0.3s;
  pointer-events: none;
  z-index: 999;
  white-space: nowrap;
}

.toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

/* Section heading */
.sec-heading {
  font-size: 12px;
  font-weight: 800;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
  margin-top: 4px;
}
</style>
</head>
<body>

<!-- Floating paw decorations -->
<div class="paw-float" style="top:15%;left:5%;--dur:4s;--delay:-1s;--rot:-20deg">ğŸ¾</div>
<div class="paw-float" style="top:60%;right:4%;--dur:5s;--delay:-2.5s;--rot:15deg">ğŸ¾</div>
<div class="paw-float" style="top:35%;right:8%;--dur:3.5s;--delay:-0.5s;--rot:30deg">ğŸ¾</div>

<div class="toast" id="toast"></div>

<div class="app">
  <!-- Top bar -->
  <div class="topbar">
    <span class="cat-face">ğŸ±</span>
    <div class="app-title">çŒ«è¯­ç¿»è¯‘å™¨</div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab(0,this)">
      <span class="tab-icon">ğŸ”¤</span>ç¿»è¯‘
    </button>
    <button class="tab-btn" onclick="switchTab(1,this)">
      <span class="tab-icon">ğŸ’­</span>å¿ƒæƒ…
    </button>
    <button class="tab-btn" onclick="switchTab(2,this)">
      <span class="tab-icon">ğŸ”Š</span>çŒ«å«
    </button>
  </div>

  <!-- Pages -->
  <div class="pages">

    <!-- â”€â”€ Page 0: Translate â”€â”€ -->
    <div class="page active" id="page-0">
      <div class="card">
        <!-- Mode toggle -->
        <div class="mode-row">
          <button class="mode-pill active" id="mode-h2c" onclick="setMode('h2c')">äººè¯ â†’ çŒ«è¯­</button>
          <button class="swap-btn" onclick="swapMode()" title="äº¤æ¢">â‡„</button>
          <button class="mode-pill" id="mode-c2h" onclick="setMode('c2h')">çŒ«è¯­ â†’ äººè¯</button>
        </div>

        <!-- Input -->
        <div class="input-label">
          <span id="inputIcon">ğŸ‘¤</span>
          <span id="inputLabel">è¾“å…¥äººè¯</span>
        </div>
        <textarea id="inputText" rows="3" placeholder="è¾“å…¥ä½ æƒ³è¯´çš„è¯ï¼Œæœ¬å–µæ¥ç¿»è¯‘å–µï½"></textarea>

        <!-- Record button (catâ†’human mode) -->
        <div class="record-wrap" id="recordWrap" style="display:none">
          <button class="record-btn" id="recordBtn" onclick="toggleRecord()">ğŸ¤</button>
          <span class="record-label" id="recordLabel">ç‚¹å‡»å½•åˆ¶çŒ«å«å£°</span>
        </div>

        <!-- Translate button -->
        <button class="translate-btn" onclick="doTranslate()" id="translateBtn">
          âœ¨ ç¿»è¯‘å–µï½
        </button>

        <!-- Output -->
        <div id="outputWrap" style="display:none">
          <div class="input-label">
            <span id="outputIcon">ğŸ¾</span>
            <span id="outputLabel">çŒ«è¯­ç»“æœ</span>
          </div>
          <div class="output-card">
            <div class="output-text" id="outputText"></div>
            <button class="copy-btn" onclick="copyOutput()" title="å¤åˆ¶">ğŸ“‹</button>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ Page 1: Mood â”€â”€ -->
    <div class="page" id="page-1">
      <div class="mood-hero">
        <span class="mood-cat-big" id="moodCatBig">ğŸ±</span>
        <div class="mood-title">ä»Šæ—¥çŒ«è¯­å½•</div>
        <div class="mood-sub">æœ¬å–µä»Šå¤©çš„å†…å¿ƒç‹¬ç™½</div>
      </div>

      <!-- Mood card -->
      <div class="mood-card-display" id="moodCardDisplay" style="background: linear-gradient(135deg,#ff6b9d,#c084fc)">
        <div class="mood-emoji-big" id="moodEmoji">ğŸ˜º</div>
        <div class="mood-name" id="moodName">ç‚¹å‡»ç”Ÿæˆå¿ƒæƒ…</div>
        <div class="mood-quote" id="moodQuote">æœ¬å–µç°åœ¨æ˜¯è–›å®šè°”çš„å¿ƒæƒ…ï¼Œè§‚æµ‹å‰ä¸ç¡®å®š</div>
      </div>

      <button class="generate-btn" onclick="generateMood()">
        ğŸ² éšæœºä¸€æ¡å–µè¯­å½•
      </button>

      <div class="sec-heading">é€‰æ‹©å¿ƒæƒ…</div>
      <div class="mood-chips" id="moodChips"></div>
    </div>

    <!-- â”€â”€ Page 2: Meow â”€â”€ -->
    <div class="page" id="page-2">
      <div class="meow-hero">
        <div class="mood-title">çŒ«å«æ’­æ”¾å™¨</div>
        <div class="mood-sub">å„ç§å¿ƒæƒ…çš„å–µå£°</div>

        <button class="big-meow-btn" id="bigMeowBtn" onclick="playBigMeow()">
          <span id="bigMeowFace">ğŸ˜¸</span>
          <span class="btn-label" id="bigMeowLabel">ç‚¹æˆ‘å–µå«</span>
        </button>

        <div class="waveform" id="waveform">
          <div class="wave-bar"></div>
          <div class="wave-bar"></div>
          <div class="wave-bar"></div>
          <div class="wave-bar"></div>
          <div class="wave-bar"></div>
          <div class="wave-bar"></div>
          <div class="wave-bar"></div>
        </div>
      </div>

      <div class="sec-heading">é€‰æ‹©å¿ƒæƒ…çŒ«å«</div>
      <div class="sound-grid" id="soundGrid"></div>

      <div class="guide-card">
        <div class="guide-title">ğŸ“ å–µè¯­æŒ‡å—</div>
        <div class="guide-row"><span class="guide-sound">çŸ­ä¿ƒã€Œå–µã€</span><span class="guide-meaning">æ‰“æ‹›å‘¼ / æƒ³è¦ä¸œè¥¿</span></div>
        <div class="guide-row"><span class="guide-sound">æ‹–é•¿ã€Œå–µï½ã€</span><span class="guide-meaning">æ’’å¨‡ / æ±‚æ‘¸æ‘¸</span></div>
        <div class="guide-row"><span class="guide-sound">è¿ç»­ã€Œå–µå–µå–µã€</span><span class="guide-meaning">æ€¥åˆ‡ / é¥¿äº†ï¼</span></div>
        <div class="guide-row"><span class="guide-sound">ä½æ²‰ã€Œå—·å‘œã€</span><span class="guide-meaning">ä¸é«˜å…´ / è­¦å‘Š</span></div>
        <div class="guide-row"><span class="guide-sound">å°å£°ã€Œå’•å™œã€</span><span class="guide-meaning">æ»¡è¶³ / å¼€å¿ƒ</span></div>
      </div>
    </div>

  </div><!-- /pages -->
</div><!-- /app -->

<script>
// â”€â”€ æ•°æ® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const MOODS = [
  { emoji:'ğŸ˜¸', name:'å¿ƒæƒ…å¤§å¥½',  quote:'ä»Šå¤©é˜³å…‰æ­£å¥½ï¼Œæœ¬å–µå†³å®šæŠŠè‚šçš®çŒ®ç»™æš–å…‰ã€‚',       grad:['#FFD700','#FFA500'] },
  { emoji:'ğŸ˜¾', name:'å¾®å¾®ä¸çˆ½',  quote:'ä½ åŠ¨äº†æˆ‘çš„çŒ«çªã€‚æˆ‘è®°ä½äº†ã€‚',                   grad:['#FF6B6B','#EE5A24'] },
  { emoji:'ğŸ˜º', name:'æƒ³è¦æ’¸æ’¸',  quote:'å—¯......å…¶å®ä½ ç°åœ¨æ‘¸æˆ‘çš„è¯ï¼Œæœ¬å–µä¸ä¼šæ‹’ç»çš„ã€‚', grad:['#FF9F7E','#FF6B9D'] },
  { emoji:'ğŸ™€', name:'å¤§å—éœ‡æ’¼',  quote:'åˆšæ‰çª—å¤–æœ‰åªé¸½å­ï¼ï¼ï¼ï¼ï¼ï¼',                 grad:['#A78BFA','#7C3AED'] },
  { emoji:'ğŸ˜´', name:'å›°å¾—è¦æ­»',  quote:'æ˜¨æ™šå·¡é€»äº†ä¸€æ•´æ™šï¼Œç°åœ¨è¦ç¡åå…­ä¸ªå°æ—¶ã€‚å‹¿æ‰°ã€‚', grad:['#60A5FA','#3B82F6'] },
  { emoji:'ğŸ˜¹', name:'æš—ä¸­å¾—æ„',  quote:'ä½ æ‰¾äº†åŠå°æ—¶çš„å‘åœˆï¼Œåœ¨æˆ‘è¿™é‡Œï¼Œå“ˆã€‚',           grad:['#34D399','#059669'] },
  { emoji:'ğŸ±', name:'å“²å­¦æ²‰æ€',  quote:'çª—å¤–çš„é›¨ï¼ŒçŒ«ç¢—é‡Œçš„æ°´ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯æ°´ã€‚',         grad:['#94A3B8','#64748B'] },
  { emoji:'ğŸ˜¿', name:'è½»å¾®å§”å±ˆ',  quote:'ä½ å‡ºé—¨çš„æ—¶å€™æ²¡å’Œæˆ‘è¯´å†è§ã€‚',                   grad:['#F472B6','#EC4899'] },
  { emoji:'ğŸ˜¼', name:'éœ¸é“æ€»è£',  quote:'è¿™ä¸ªå®¶ï¼Œä»æ²™å‘åˆ°é˜³å°ï¼Œéƒ½æ˜¯æœ¬å–µçš„é¢†åœ°ã€‚',       grad:['#FB923C','#F97316'] },
  { emoji:'ğŸˆ', name:'è‹¥æ— å…¶äº‹',  quote:'é‚£ä¸ªèŠ±ç“¶ï¼Ÿä¸çŸ¥é“ï¼Œæ˜¯è‡ªå·±æ‰çš„ã€‚',               grad:['#4ADE80','#22C55E'] },
];

const SOUNDS = [
  { emoji:'ğŸ˜º', name:'å¼€å¿ƒå–µ',   text:'å–µï½å–µå–µï½' },
  { emoji:'ğŸ˜¾', name:'ä¸çˆ½å–µ',   text:'å—·å‘œï¼ï¼' },
  { emoji:'ğŸ˜¸', name:'æ’’å¨‡å–µ',   text:'å–µå–µå–µå–µï½' },
  { emoji:'ğŸ™€', name:'å—æƒŠå–µ',   text:'å–µï¼ï¼ï¼' },
  { emoji:'ğŸ˜´', name:'æ‡’æ´‹æ´‹',   text:'...å–µ...' },
  { emoji:'ğŸ˜¹', name:'å¤§ç¬‘å–µ',   text:'å–µå“ˆå“ˆå“ˆ' },
];

// â”€â”€ ç¿»è¯‘å¼•æ“ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SHORT_P  = ['å—¯ã€‚','æˆ‘åœ¨ã€‚','çŸ¥é“äº†ã€‚','å«æˆ‘å¹²å˜›ï¼Ÿ','åˆ«çƒ¦æˆ‘ã€‚','æˆ‘å›°äº†ã€‚','æœ‰åƒçš„å—ï¼Ÿ'];
const NORMAL_P = ['ä½ ä»Šå¤©è¿˜ä¸é”™ï¼Œæ‘¸å¤´æ€ä¸€ä¸‹ã€‚','æœ¬å–µæƒ³è¦ç½å¤´ï¼Œå¿«å»ä¹°ã€‚','å¤ªé˜³å¾ˆå¥½ï¼Œæˆ‘è¦å»æ™’è‚šå­äº†ã€‚','ä½ ä»€ä¹ˆæ—¶å€™å›æ¥ï¼Ÿæˆ‘æƒ³ä½ äº†ï¼ˆä½†ä¸ä¼šè¯´å‡ºå£ï¼‰ã€‚','å¸®æˆ‘æŒ ä¸€ä¸‹ä¸‹å·´ï¼Œæœ¬å–µèµä½ ã€‚','æˆ‘åˆšæ‰åœ¨åšæ¢¦ï¼Œæ¢¦é‡Œæœ‰æ— é™çŒ«ç²®ã€‚'];
const LONG_P   = ['å‘¼å™œå‘¼å™œï½æœ¬å–µå¿ƒæƒ…å¤§å¥½ï¼Œä»Šå¤©å¯ä»¥å¤šæ‘¸äº”ç§’ã€‚','è¿™ä¸ªä½ç½®æ˜¯æˆ‘çš„ï¼Œä½ åå“ªé‡Œéƒ½è¡Œï¼Œé™¤äº†è¿™é‡Œã€‚','æˆ‘å…¶å®å¾ˆæƒ³ä½ ï¼Œä½†ä½œä¸ºä¸€åªçŒ«ï¼Œä¸èƒ½è¡¨ç°å¾—å¤ªæ˜æ˜¾ã€‚','åˆšæ‰çª—å¤–æœ‰åªé¸Ÿï¼Œå¥½çƒ¦ï¼Œå·®ç‚¹æ²¡å¿ä½ã€‚'];
const REPEAT_P = ['å¿«ç‚¹å¿«ç‚¹ï¼ç½å¤´æ—¶é—´åˆ°äº†ï¼','æˆ‘è¯´äº†å¾ˆå¤šéäº†ï¼Œè¿™ä¸ªç©å…·ä¸å¥½ç©ï¼','æœ‰äººåœ¨å—ï¼Ÿï¼æˆ‘çš„ç¢—ç©ºäº†ï¼ï¼','å†ä¸ç†æˆ‘æˆ‘å°±æŠŠæ¯å­æ¨ä¸‹å»ï¼ï¼'];
const ANGRY_P  = ['ä½ ç¢°äº†æˆ‘çš„å°¾å·´ï¼ï¼','æœ¬å–µä¸é«˜å…´ï¼Œåæœè‡ªè´Ÿã€‚','å†é è¿‘ä¸€æ­¥è¯•è¯•ï¼Ÿï¼','ä½ åˆšæ‰è¸©åˆ°æˆ‘äº†ï¼Œä¸èƒ½åŸè°…ã€‚'];
const STORY_P  = ['ä»Šå¤©æˆ‘å»å·¡è§†äº†ä¸€éé¢†åœ°ï¼Œå‘ç°æ²™å‘è§’æœ‰ä¸ªå¥‡æ€ªçš„å‘³é“ï¼Œè°ƒæŸ¥äº†ä¸¤ä¸ªå°æ—¶ï¼ŒåŸæ¥æ˜¯ä½ æ–°ä¹°çš„æ´—è¡£æ¶²ã€‚ä¸å–œæ¬¢ã€‚','æˆ‘è®¤çœŸè€ƒè™‘è¿‡äº†ï¼Œå†³å®šåŸè°…ä½ æ˜¨å¤©å¿˜äº†ç»™æˆ‘å¼€ç©ºè°ƒè¿™ä»¶äº‹ã€‚ä½†åªæœ‰è¿™ä¸€æ¬¡ã€‚','æˆ‘åˆšæ‰æ‰“äº†ä¸ªç›¹ï¼Œæ¢¦åˆ°è‡ªå·±æ˜¯è‰åŸä¸Šæœ€å‰å®³çš„çŒæ‰‹ã€‚é†’æ¥å‘ç°æ˜¯åªå®¶çŒ«ã€‚æœ‰ç‚¹å¤±è½ï¼Œä½†ç½å¤´è¿˜æ˜¯è¦åƒçš„ã€‚'];

function rand(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

function humanToCat(text) {
  if (!text.trim()) return '';
  const words = text.split(/\s+/).filter(Boolean);
  const result = words.map((w, i) => {
    const len = Math.max(1, w.length);
    const bases = ['å–µ', 'miao', 'å–µ~', 'Miao'];
    const angryW = ['ä¸','è®¨åŒ','çƒ¦','ç”Ÿæ°”','æ»š','å'];
    const happyW = ['çˆ±','å¥½','å–œ','å¼€å¿ƒ','å¿«ä¹','æ£’','èµ'];
    const isAngry = angryW.some(x => w.includes(x));
    const isHappy = happyW.some(x => w.includes(x));
    if (isAngry) return 'å—·' + 'å‘œ'.repeat(Math.min(len, 2));
    if (isHappy) return 'å–µ' + 'ï¼'.repeat(Math.min(len, 2));
    if (len <= 2) return 'å–µ';
    if (len <= 4) return 'å–µå–µ';
    return bases[i % bases.length];
  });
  let out = result.join(' ');
  if (text.match(/[ï¼Ÿ?]/)) out += 'ï¼Ÿå–µ~';
  else if (text.match(/[ï¼!]/)) out += 'ï¼ï¼ï¼';
  else out += '~';
  return out;
}

function catToHuman(text) {
  const lower = text.toLowerCase();
  const len = text.length;
  const hasRepeat = /å–µ{3,}|miao.*miao/i.test(text);
  const hasLong = /[ï½~]/.test(text);
  const isAngry = /[ï¼!]{2,}|å—·/.test(text);
  if (isAngry) return rand(ANGRY_P);
  if (len <= 4 && !hasRepeat) return rand(SHORT_P);
  if (hasLong) return rand(LONG_P);
  if (hasRepeat) return rand(REPEAT_P);
  if (len > 15) return rand(STORY_P);
  return rand(NORMAL_P);
}

// â”€â”€ çŠ¶æ€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let mode = 'h2c'; // h2c | c2h
let currentMoodIdx = 0;
let isRecording = false;
let speechRecognition = null;
let playingSound = -1;
let synth = window.speechSynthesis;

// â”€â”€ Tab åˆ‡æ¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchTab(idx, btn) {
  document.querySelectorAll('.tab-btn').forEach((b,i) => {
    b.classList.toggle('active', i === idx);
  });
  document.querySelectorAll('.page').forEach((p,i) => {
    p.classList.toggle('active', i === idx);
  });
}

// â”€â”€ ç¿»è¯‘æ¨¡å¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setMode(m) {
  mode = m;
  document.getElementById('mode-h2c').classList.toggle('active', m === 'h2c');
  document.getElementById('mode-c2h').classList.toggle('active', m === 'c2h');
  document.getElementById('inputIcon').textContent  = m === 'h2c' ? 'ğŸ‘¤' : 'ğŸ±';
  document.getElementById('inputLabel').textContent = m === 'h2c' ? 'è¾“å…¥äººè¯' : 'è¾“å…¥çŒ«è¯­ï¼ˆæˆ–å½•éŸ³ï¼‰';
  document.getElementById('outputIcon').textContent  = m === 'h2c' ? 'ğŸ¾' : 'ğŸ‘¤';
  document.getElementById('outputLabel').textContent = m === 'h2c' ? 'çŒ«è¯­ç»“æœ' : 'äººè¯ç¿»è¯‘';
  const input = document.getElementById('inputText');
  input.placeholder = m === 'h2c' ? 'è¾“å…¥ä½ æƒ³è¯´çš„è¯ï¼Œæœ¬å–µæ¥ç¿»è¯‘å–µï½' : 'è¾“å…¥å–µå–µå–µï¼Œæˆ–ç‚¹å‡»å½•éŸ³æŒ‰é’®...';
  document.getElementById('recordWrap').style.display = m === 'c2h' ? 'flex' : 'none';
  document.getElementById('outputWrap').style.display = 'none';
}

function swapMode() {
  const newMode = mode === 'h2c' ? 'c2h' : 'h2c';
  const curOut = document.getElementById('outputText').textContent;
  const curIn  = document.getElementById('inputText').value;
  setMode(newMode);
  document.getElementById('inputText').value = curOut;
  if (curOut) doTranslate();
}

function doTranslate() {
  const text = document.getElementById('inputText').value.trim();
  if (!text) return;
  const result = mode === 'h2c' ? humanToCat(text) : catToHuman(text);
  document.getElementById('outputText').textContent = result;
  const wrap = document.getElementById('outputWrap');
  wrap.style.display = 'block';
  // re-trigger animation
  const card = wrap.querySelector('.output-card');
  card.style.animation = 'none';
  requestAnimationFrame(() => { card.style.animation = ''; });
}

function copyOutput() {
  const text = document.getElementById('outputText').textContent;
  if (!text) return;
  navigator.clipboard?.writeText(text).then(() => showToast('å·²å¤åˆ¶å–µï½ ğŸ“‹'));
}

// â”€â”€ å½•éŸ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleRecord() {
  if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
    showToast('è¯¥æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«å–µ ğŸ˜¿');
    return;
  }
  if (isRecording) {
    stopRecord();
  } else {
    startRecord();
  }
}

function startRecord() {
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  speechRecognition = new SR();
  speechRecognition.lang = 'zh-CN';
  speechRecognition.continuous = false;
  speechRecognition.interimResults = true;

  speechRecognition.onresult = (e) => {
    const transcript = Array.from(e.results).map(r => r[0].transcript).join('');
    document.getElementById('inputText').value = transcript;
    if (e.results[e.results.length-1].isFinal) {
      doTranslate();
      stopRecord();
    }
  };

  speechRecognition.onerror = () => {
    showToast('å½•éŸ³å‡ºé”™äº†å–µ ğŸ˜¿');
    stopRecord();
  };

  speechRecognition.onend = () => stopRecord();

  speechRecognition.start();
  isRecording = true;
  document.getElementById('recordBtn').classList.add('recording');
  document.getElementById('recordBtn').textContent = 'â¹';
  document.getElementById('recordLabel').textContent = 'å½•éŸ³ä¸­...å†æŒ‰åœæ­¢';
}

function stopRecord() {
  speechRecognition?.stop();
  isRecording = false;
  document.getElementById('recordBtn').classList.remove('recording');
  document.getElementById('recordBtn').textContent = 'ğŸ¤';
  document.getElementById('recordLabel').textContent = 'ç‚¹å‡»å½•åˆ¶çŒ«å«å£°';
}

// â”€â”€ å¿ƒæƒ… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderMoodChips() {
  const container = document.getElementById('moodChips');
  container.innerHTML = MOODS.map((m, i) => `
    <div class="mood-chip ${i === 0 ? 'selected' : ''}" onclick="selectMood(${i})" id="chip-${i}">
      <div class="chip-emoji">${m.emoji}</div>
      <div class="chip-name">${m.name}</div>
    </div>
  `).join('');
}

function selectMood(idx) {
  currentMoodIdx = idx;
  const mood = MOODS[idx];
  document.querySelectorAll('.mood-chip').forEach((c, i) => c.classList.toggle('selected', i === idx));
  updateMoodCard(mood);
}

function updateMoodCard(mood) {
  document.getElementById('moodEmoji').textContent = mood.emoji;
  document.getElementById('moodName').textContent = mood.name;
  document.getElementById('moodQuote').textContent = mood.quote;
  document.getElementById('moodCatBig').textContent = mood.emoji;
  const card = document.getElementById('moodCardDisplay');
  card.style.background = `linear-gradient(135deg, ${mood.grad[0]}, ${mood.grad[1]})`;
  // bounce
  card.style.transform = 'scale(0.95)';
  setTimeout(() => card.style.transform = '', 300);
}

function generateMood() {
  const idx = Math.floor(Math.random() * MOODS.length);
  selectMood(idx);
  // update chip scroll
  document.getElementById('chip-' + idx)?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

// â”€â”€ çŒ«å« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderSoundGrid() {
  const container = document.getElementById('soundGrid');
  container.innerHTML = SOUNDS.map((s, i) => `
    <button class="sound-btn" id="sound-${i}" onclick="playSound(${i})">
      <div class="s-emoji">${s.emoji}</div>
      <span class="s-name">${s.name}</span>
    </button>
  `).join('');
}

function speakText(text, pitch = 1.8, rate = 0.4) {
  if (!synth) return;
  synth.cancel();
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'zh-CN';
  utter.pitch = pitch;
  utter.rate = rate;
  utter.volume = 1;
  synth.speak(utter);
  return utter;
}

function playBigMeow() {
  const btn = document.getElementById('bigMeowBtn');
  const face = document.getElementById('bigMeowFace');
  const label = document.getElementById('bigMeowLabel');
  const waveform = document.getElementById('waveform');

  btn.classList.add('playing');
  face.textContent = 'ï¼ˆ>Ï‰<ï¼‰';
  label.textContent = 'å–µå–µå–µï½';
  waveform.classList.add('active');

  speakText('å–µï½å–µå–µï½å–µå–µå–µ');

  setTimeout(() => {
    btn.classList.remove('playing');
    face.textContent = 'ğŸ˜¸';
    label.textContent = 'ç‚¹æˆ‘å–µå«';
    waveform.classList.remove('active');
  }, 2000);
}

function playSound(idx) {
  // Clear previous
  document.querySelectorAll('.sound-btn').forEach(b => b.classList.remove('playing'));
  document.getElementById('sound-' + idx).classList.add('playing');
  playingSound = idx;

  const s = SOUNDS[idx];
  const isAngry = idx === 1 || idx === 3;
  const isSleepy = idx === 4;
  speakText(s.text, isAngry ? 1.2 : isSleepy ? 2.2 : 2.0, isAngry ? 0.3 : isSleepy ? 0.25 : 0.4);

  // Also animate big button
  const bigBtn = document.getElementById('bigMeowBtn');
  const bigFace = document.getElementById('bigMeowFace');
  const waveform = document.getElementById('waveform');
  bigBtn.classList.add('playing');
  bigFace.textContent = s.emoji;
  waveform.classList.add('active');

  setTimeout(() => {
    document.getElementById('sound-' + idx)?.classList.remove('playing');
    bigBtn.classList.remove('playing');
    bigFace.textContent = 'ğŸ˜¸';
    waveform.classList.remove('active');
    playingSound = -1;
  }, 1800);
}

// â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

// â”€â”€ Enter é”®ç¿»è¯‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('inputText').addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    doTranslate();
  }
});

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderMoodChips();
renderSoundGrid();
updateMoodCard(MOODS[0]);
</script>
</body>
</html>
